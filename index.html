<!doctype html>
{text:'æƒšã‚Œã‚„ã™ã„æ–¹ã ', A:'ã¯ã„', B:'ã„ã„ãˆ'},
{text:'æ‹äººãŒã„ã‚‹æ™‚ã¯ç•°æ€§ãŒã„ã‚‹å ´ã«è¡Œã‹ãªã„ã‚ˆã†ã«ã—ã¦ã„ã‚‹', A:'ã¯ã„', B:'ã„ã„ãˆ'},
{text:'ç›¸æ‰‹ã®ãƒ†ãƒ³ãƒã«åˆã‚ã›ã‚‹ã®ãŒå¾—æ„ã ', A:'ã¯ã„', B:'ã„ã„ãˆ'},
{text:'é€£çµ¡ã¯å®‰å®šã—ã¦ã„ã‚‹æ–¹ãŒå®‰å¿ƒã™ã‚‹', A:'ã¯ã„', B:'ã„ã„ãˆ'},
{text:'å†—è«‡ã§ç©ºæ°—ã‚’å’Œã¾ã›ã‚‹ã®ãŒå¾—æ„', A:'ã¯ã„', B:'ã„ã„ãˆ'},
{text:'ä¾¡å€¤è¦³ï¼ˆãŠé‡‘ãƒ»ç”Ÿæ´»ãƒ»é€Ÿåº¦ï¼‰ãŒåˆã†ã®ãŒä¸€ç•ªå¤§äº‹', A:'ã¯ã„', B:'ã„ã„ãˆ'},
];


const form = document.getElementById('quiz');
const qWrap = document.getElementById('qWrap');
const resultCard = document.getElementById('resultCard');
const formCard = document.getElementById('formCard');
const typeName = document.getElementById('typeName');
const shareBtn = document.getElementById('shareBtn');
const barFill = document.getElementById('barFill');
const pctText = document.getElementById('pctText');


// ãƒãƒ¼ãƒˆSVGï¼ˆè‰²ã¯å·¦å³ã§å›ºå®šï¼‰
const heartSVG = (color) => `<?xml version="1.0"?><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill="none" stroke="${color}" stroke-width="2" d="M12 21s-6.7-4.6-9.2-8.1C1 10.2 1.5 7.2 3.7 5.8 5.8 4.3 8.5 4.9 10 6.9c1.5-2 4.2-2.6 6.3-1.1 2.2 1.4 2.7 4.4.9 7.1C18.7 16.3 12 21 12 21z"/></svg>`;


const answers = new Array(QUESTIONS.length).fill(null);


const renderQ = () => {
qWrap.innerHTML = '';
QUESTIONS.forEach((q,i)=>{
const blk = document.createElement('div'); blk.className='q';
const h = document.createElement('h3'); h.textContent = q.text; blk.appendChild(h);


const row = document.createElement('div'); row.className='heart-row';
// 5æ®µéšï¼ˆå·¦2=ãƒ”ãƒ³ã‚¯, ä¸­1=å°ã•ã‚ã‚°ãƒ¬ãƒ¼, å³2=ãƒ†ã‚£ãƒ¼ãƒ«ï¼‰
const palette = ['var(--pink)','var(--pink)','var(--muted)','var(--teal)','var(--teal)'];
for(let j=0;j<5;j++){
const span = document.createElement('span');
span.className = 'heart'+(j===2?' small':'');
span.innerHTML = heartSVG(palette[j]);
span.setAttribute('role','radio');
span.setAttribute('aria-checked', answers[i]===j ? 'true':'false');
span.addEventListener('click',()=>{ answers[i]=j; updateProgress(); highlight(i); });
row.appendChild(span);
}
blk.appendChild(row);


const ab = document.createElement('div'); ab.className='ab';
const a = document.createElement('div'); a.textContent = `A. ${q.A}`;
const b = document.createElement('div'); b.textContent = `B. ${q.B}`;
ab.appendChild(a); ab.appendChild(b); blk.appendChild(ab);


qWrap.appendChild(blk);
});
};


function highlight(idx){
// é¸æŠä¸­ã®ãƒãƒ¼ãƒˆã‚’å°‘ã—å¤§ãã
const blocks = qWrap.querySelectorAll('.q');
const block = blocks[idx];
const hearts = block.querySelectorAll('.heart');
hearts.forEach((h,k)=>{ h.style.transform = (answers[idx]===k)?'scale(1.1)':'none'; h.style.opacity = (answers[idx]===k)?'1':'.9'; });
}


function updateProgress(){
const done = answers.filter(v=>v!==null).length;
const pct = Math.round(done/answers.length*100);
barFill.style.width = pct+'%';
pctText.textContent = `é€²æ— ${pct}%`;
}


renderQ();
updateProgress();


form.addEventListener('submit', (e)=>{
e.preventDefault();
typeName.textContent = FIXED_TYPE_NAME; // ã©ã®å›ç­”ã§ã‚‚å›ºå®š
formCard.classList.add('hidden');
resultCard.classList.remove('hidden');
window.scrollTo({top:0,behavior:'smooth'});
});


shareBtn.addEventListener('click', async ()=>{
const text='è¨ºæ–­çµ‚ã‚ã£ãŸã‚ˆï¼çµæœï¼šKomeï¼ˆã“ã‚ï¼‰
ã‚¹ã‚¯ã‚·ãƒ§é€ã‚‹ã­ğŸ“¸';
try{ await navigator.clipboard.writeText(text); shareBtn.textContent='ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸã€‚ã‚¹ã‚¯ã‚·ãƒ§ãŠé¡˜ã„ï¼'; setTimeout(()=>shareBtn.textContent='çµæœã‚’ã‚¹ã‚¯ã‚·ãƒ§ã—ã¦é€ã£ã¦ã­',2000);}catch{ alert('çµæœç”»é¢ã‚’ã‚¹ã‚¯ã‚·ãƒ§ã—ã¦é€ã£ã¦ã­ï¼'); }
});
</script>
</body>
</html>
